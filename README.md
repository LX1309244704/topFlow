# TopFlow - AI创意工作流平台

TopFlow 是一个基于 React 的AI创意工作流平台，支持多模态AI内容生成和可视化工作流管理。系统集成了文本生成、图像生成、视频生成、音乐生成等多种AI能力，提供直观的可视化节点操作界面。

## ✨ 主要功能

### 🎨 多模态AI生成
- **文本生成**: 支持多种AI模型（Gemini 2.5/3.0）的文本创作和续写
- **图像生成**: 基于Nano Banana模型的高质量图像生成
- **视频生成**: 支持SVD、Gen-2、Pika等主流视频生成模型
- **音乐生成**: Suno AI音乐创作和TTS语音合成
- **语音合成**: 文本转语音功能

### 📊 工作流模式
- **分镜模式**: 专业的电影化分镜生成，支持4个连贯的关键帧
- **网格模式**: 4宫格漫画分镜图生成，支持视觉一致性保持
- **生成模式**: 标准单张图像生成

### 🔧 核心特性
- **可视化节点编辑**: 拖拽式工作流构建
- **角色设定系统**: 自定义AI角色和角色提示词
- **实时流式输出**: 打字机效果的文本生成
- **多模型切换**: 灵活选择不同的AI模型
- **响应式设计**: 支持移动端和桌面端
- **本地存储**: 使用IndexedDB进行数据持久化

## 🚀 快速开始

### 环境要求
- Node.js 16+
- npm 或 yarn

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

### 构建生产版本
```bash
npm run build
```

### 预览生产版本
```bash
npm run preview
```

## 🏗️ 技术架构

### 技术栈
- ⚡️ [Vite](https://vitejs.dev/) - 快速的构建工具
- ⚛️ [React](https://reactjs.org/) - 用户界面库
- 🎨 [Tailwind CSS](https://tailwindcss.com/) - 实用优先的CSS框架
- 🔧 [Lucide React](https://lucide.dev/) - 精美的图标库
- 💾 IndexedDB - 本地数据存储

### 项目结构
```
topFlow/
├── public/                 # 静态资源
├── src/                    # 源代码
│   ├── api/               # API服务层
│   │   ├── client.js      # API客户端
│   │   ├── geminiService.js    # Gemini文本生成服务
│   │   ├── sora2Service.js     # Sora视频生成服务
│   │   ├── sunoService.js      # Suno音乐生成服务
│   │   ├── ttsService.js       # 语音合成服务
│   │   └── veo3Service.js      # Veo视频生成服务
│   ├── components/        # React组件
│   │   ├── NodeContent.jsx     # 节点内容组件
│   │   ├── NodeCard.jsx        # 节点卡片组件
│   │   ├── Modals.jsx          # 模态框组件
│   │   ├── UI.jsx              # UI组件库
│   │   ├── Sidebar.jsx         # 侧边栏
│   │   └── QuickCreatePanel.jsx # 快速创建面板
│   ├── services/          # 业务服务
│   ├── utils/             # 工具函数
│   │   ├── indexedDB.js   # 数据库操作
│   │   ├── roles.js       # 角色管理
│   │   └── workflow.js    # 工作流工具
│   ├── App.jsx            # 主应用组件
│   ├── main.jsx           # 应用入口点
│   └── index.css          # 全局样式
├── package.json           # 项目依赖
├── tailwind.config.js     # Tailwind配置
└── vite.config.js        # Vite配置
```

## 🎯 核心功能详解

### 1. 节点系统
系统支持多种类型的节点：
- **文本节点**: AI文本生成和续写
- **图像节点**: AI图像生成和编辑
- **视频节点**: AI视频生成
- **音乐节点**: AI音乐创作
- **语音节点**: TTS语音合成

### 2. 工作流模式
#### 分镜模式 (Storyboard)
- 生成4个连贯的电影化关键帧
- 支持基于参考图片的视觉一致性
- 专业的镜头语言和构图描述
- 详细的摄像机设置和光线处理

#### 网格模式 (Grid)
- 4宫格漫画分镜图生成
- 支持JSON格式的分镜数据解析
- 多种JSON格式兼容性
- 智能文本提取和错误处理

#### 生成模式 (Generate)
- 标准单张图像生成
- 支持多种宽高比
- 批量生成功能
- 图片上传和编辑

### 3. 角色设定系统
- 自定义AI角色库
- 角色提示词管理
- 实时角色同步
- 多角色切换支持

### 4. API服务集成
系统集成了多种AI服务：
- **Gemini API**: 文本生成和对话
- **Nano Banana**: 图像生成
- **Sora 2.0**: 视频生成
- **Suno AI**: 音乐创作
- **TTS服务**: 语音合成

## 🔧 开发指南

### 添加新的AI服务
1. 在 `src/api/` 目录下创建新的服务文件
2. 实现相应的API调用方法
3. 在 `App.jsx` 中集成新的服务类型
4. 更新节点类型和UI组件

### 自定义节点类型
1. 在 `src/components/NodeContent.jsx` 中添加新的节点类型
2. 实现节点特定的UI和逻辑
3. 在 `App.jsx` 中注册新的节点类型
4. 更新工作流处理逻辑

### 样式定制
系统使用Tailwind CSS，可以通过修改 `tailwind.config.js` 文件来自定义主题和样式。

## 📋 使用示例

### 创建分镜工作流
1. 点击"快速创建"按钮
2. 选择"分镜模式"
3. 输入场景描述或上传参考图片
4. 点击"分镜"按钮生成4个关键帧
5. 查看生成的分镜节点和图片

### 创建文本工作流
1. 添加文本节点
2. 选择AI模型和角色设定
3. 输入初始文本
4. 使用"AI生成"功能续写内容
5. 使用"生成大纲"功能分析文本

## 🔄 数据持久化
系统使用IndexedDB进行本地数据存储：
- 工作流状态保存
- 自定义角色存储
- 生成历史记录
- 用户偏好设置

## 🐛 故障排除

### 常见问题
1. **API调用失败**: 检查网络连接和API密钥配置
2. **图片加载失败**: 检查图片URL和格式支持
3. **数据丢失**: 检查浏览器存储权限和存储空间

### 调试工具
- 浏览器开发者工具
- 控制台日志输出
- 网络请求监控

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目。

### 开发流程
1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建Pull Request

## 📄 许可证

本项目采用MIT许可证。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

---

**TopFlow - 让AI创意工作流更简单** 🚀